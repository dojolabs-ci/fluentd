<source>
  @type tail
  read_from_head true
  path /var/log/snort/alerts.csv
  pos_file /fluentd/log/snort-alerts.csv.pos
  format csv
  tag snort
  keys log_timestamp,sig_generator,sig_id,sig_rev,msg,proto,src_ip,src_port,dst_ip,dst_port,src_mac,dst_mac,ethlen,tcpflags,tcpseq,tcpack,tcpln,tcpwindow,ttl,tos,id,dgmlen,iplen,icmptype,icmpcode,icmpid,icmpseq
  time_key log_timestamp
</source>

<match snort>
    @type elasticsearch
    host "#{ENV['ELASTICSEARCH_HOST']}"
    port "#{ENV['ELASTICSEARCH_PORT']}"
    logstash_format true
    include_timestamp true
    logstash_prefix "#{ENV['ELASTICSEARCH_INDEX_PREFIX']}"
</match>

